(function(e){function t(t){for(var i,a,s=t[0],u=t[1],l=t[2],d=0,f=[];d<s.length;d++)a=s[d],r[a]&&f.push(r[a][0]),r[a]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);c&&c(t);while(f.length)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,s=1;s<n.length;s++){var u=n[s];0!==r[u]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},r={app:0},o=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var c=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"10e4":function(e,t,n){"use strict";var i=n("f4f2"),r=n.n(i);r.a},1162:function(e,t,n){var i={"./story1.default.json":"90c2","./story2.default.json":"dc64"};function r(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="1162"},"21f8":function(e,t,n){var i={"./story1.default.json":"90c2","./story2.default.json":"dc64"};function r(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="21f8"},2978:function(e,t,n){"use strict";var i=n("c3fa"),r=n.n(i);r.a},"3a4e":function(e,t,n){},"3e52":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy",{style:{width:e.screenSize+"px",height:e.screenSize+"px"}},[n("Img",{attrs:{src:null}}),n("Msgbox",e._b({on:{"seplayer:play":e.onSePlay,"bgmplayer:play":e.onBgmPlay}},"Msgbox",e.status,!1,!0)),n("Menu",{attrs:{title:"Main Menu"}})],1)},o=[],a=n("5d73"),s=n.n(a),u=n("f499"),l=n.n(u),c=n("308d"),d=n("6bb5"),f=n("4e2b"),p=n("f28b"),h=n("7618"),g=(n("6762"),n("2fdb"),n("a745")),v=n.n(g),y=n("d225"),m=n("b0b4"),b=n("a4bb"),w=n.n(b),j=(n("7514"),n("6b54"),function(){function e(){Object(y["a"])(this,e)}return Object(m["a"])(e,null,[{key:"getClassName",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{key:"isObject",value:function(e){return e instanceof Object&&!v()(e)}},{key:"includeKeys",value:function(e,t){return!!w()(e).find(function(e){return t.includes(e)})}}]),e}()),O=function(){function e(t){return Object(y["a"])(this,e),e.compile(t)}return Object(m["a"])(e,null,[{key:"compile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=[];switch(e.type){case"message":if(t)break;if(v()(e.value)){var i=!0,r=!1,o=void 0;try{for(var a,u=s()(e.value);!(i=(a=u.next()).done);i=!0){var l=a.value;n.push(this.compile(l,!0))}}catch(_){r=!0,o=_}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}break}return{type:"message",value:e.value||"",label:e.label||{}};case"prompt":if(t||!v()(e.value))break;for(var c=0;c<e.value.length;c++){var d=e.value[c],f="",p={};if(["string","number"].includes(Object(h["a"])(d))&&(f=d),v()(d)){if(!d.length){e.value.splice(c,1),--c;continue}["string","number"].includes(Object(h["a"])(d[0]))&&(f=d[0]),j.isObject(d[1])&&(p=d[1])}j.isObject(d)&&(d.message&&(f=d.message),d.label&&(p=d.label)),e.value[c]={message:f,label:p}}return e}if(["string","number"].includes(Object(h["a"])(e)))return t?e:{type:"message",value:e,label:{}};if(v()(e)){var g=!0,y=!1,m=void 0;try{for(var b,w=s()(e);!(g=(b=w.next()).done);g=!0){var O=b.value;n.push(this.compile(O,!0))}}catch(_){y=!0,m=_}finally{try{g||null==w.return||w.return()}finally{if(y)throw m}}}if(!n.length)throw new E;return{type:"message",value:n||"",label:e.label||{}}}}]),e}(),E=function(e){function t(){return Object(y["a"])(this,t),Object(c["a"])(this,Object(d["a"])(t).call(this,"The format of provided object doesn't match that of Dialogue"))}return Object(f["a"])(t,e),Object(m["a"])(t,[{key:"name",get:function(){return"DialogueCompileError"}}]),t}(Object(p["a"])(TypeError)),_=n("795b"),k=n.n(_),M=function(e){function t(){var e;return Object(y["a"])(this,t),e=Object(c["a"])(this,Object(d["a"])(t).call(this)),e.audios={},e}return Object(f["a"])(t,e),Object(m["a"])(t,[{key:"load",value:function(e){var t=this;return new k.a(function(n,i){t.audios[e]&&n(t.audios[e]);var r=new Audio(e);r.addEventListener("loadstart",function(){t.audios[e]=r,n(r)}),r.addEventListener("error",function(e){return i(e)})})}},{key:"play",value:function(e){this.load(e).then(function(e){return e.play()})}}]),t}(Object(p["a"])(AudioContext)),x=function(e){function t(){return Object(y["a"])(this,t),Object(c["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(f["a"])(t,e),t}(Object(p["a"])(AudioContext)),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-Menu",{attrs:{open:e.attrs.open&&""}},[n("Epilogy-Menutitle",[e._v(e._s(e.attrs.title))]),n("Epilogy-Menulist",e._l(e.items,function(t){return n("Epilogy-Menuitem",{key:t},[e._v(e._s(t))])}),1)],1)},P=[],I={props:{title:{type:String,required:!1},open:{type:Boolean,required:!1}},data:function(){return{attrs:{title:this.title,open:this.open},items:[]}},methods:{switch:function(){this.attrs.open=!this.attrs.open}},created:function(){var e=this;window.addEventListener("keydown",function(t){32===t.keyCode&&e.switch()}),window.addEventListener("keydown",function(e){switch(e.keyCode){case 38:break;case 40:break}})}},C=I,L=(n("64be"),n("2877")),$=Object(L["a"])(C,S,P,!1,null,"6a2eee00",null);$.options.__file="Menu.vue";var D=$.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-Msgbox",{attrs:{open:e.open&&""}},[n("SimpleMessage",{ref:"simpleMsg"}),n("PromptMessage",{ref:"promptMsg"})],1)},z=[],T=(n("c5f6"),n("2d1f")),U=n.n(T),K=function(){function e(){Object(y["a"])(this,e)}return Object(m["a"])(e,null,[{key:"multipleUpdate",value:function(e){for(var t=U()(e),n=0;n<t.length;n++){var i=t[n];this.$emit("update:".concat(i[0]),i[1])}}}]),e}(),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-SimpleMessage",[e._v(e._s(e.message))])},B=[],J={data:function(){return{message:""}}},R=J,q=(n("2978"),Object(L["a"])(R,A,B,!1,null,"5d05e95a",null));q.options.__file="SimpleMessage.vue";var F=q.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-PromptMessage",e._l(e.items,function(t,i){return n("Li",{key:i,attrs:{tabIndex:i+1}},[n("Span",[e._v(e._s(t.message))])],1)}),1)},W=[],G={data:function(){return{items:[]}},methods:{initSelection:function(){document.activeElement.matches("Epilogy-PromptMessage > Li")||this.$el.firstElementChild&&this.$el.firstElementChild.focus()},prev:function(){document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus()},next:function(){document.activeElement.nextElementSibling&&document.activeElement.nextElementSibling.focus()},handlekeyup:function(e){this.initSelection(),38===e.keyCode&&this.prev(),40===e.keyCode&&this.next()}},created:function(){window.addEventListener("keyup",this.handlekeyup)},beforeDestroy:function(){window.removeEventListener("keyup",this.handlekeyup)}},Q=G,V=(n("a3cc"),Object(L["a"])(Q,H,W,!1,null,"0dd50b70",null));V.options.__file="PromptMessage.vue";var X=V.exports,Y={components:{SimpleMessage:F,PromptMessage:X},props:{chapter:{type:Number},section:{type:Number},dialogueId:{type:Number}},computed:{dialogue:function(){var e=this.$parent.dialogues;return e&&e[this.dialogueId-1]||null},open:function(){return null!=this.dialogue}},methods:{render:function(e){var t=this.$refs,n=t.simpleMsg,i=t.promptMsg;if(n.message="",i.items=[],!e)return null;if("string"===typeof e)return e;var r=[];switch(e.type){case"message":if(!v()(e.value))return n.message=e.value;var o=!0,a=!1,u=void 0;try{for(var l,c=s()(e.value);!(o=(l=c.next()).done);o=!0){var d=l.value;r.push(this.render(d))}}catch(f){a=!0,u=f}finally{try{o||null==c.return||c.return()}finally{if(a)throw u}}return n.message=r.join("\n");case"prompt":i.items=e.value;break}},prev:function(){this.$emit("update:dialogueId",this.dialogueId-1)},next:function(){if(this.$emit("seplayer:play",n("9de3")),this.dialogue){if("message"===this.dialogue.type)return j.includeKeys(this.dialogue.label,["chapter","section","dialogue"])?K.multipleUpdate.call(this,{chapter:this.dialogue.label.chapter||this.chapter,section:this.dialogue.label.section||this.section,dialogueId:this.dialogue.label.dialogue||1}):this.$emit("update:dialogueId",this.dialogueId+1);if("prompt"===this.dialogue.type){if(!document.activeElement.matches("Epilogy-PromptMessage > Li"))return;var e=this.dialogue.value[document.activeElement.tabIndex-1];return j.includeKeys(e.label,["chapter","section","dialogue"])?K.multipleUpdate.call(this,{chapter:e.label.chapter||this.chapter,section:e.label.section||this.section,dialogueId:e.label.dialogue||1}):this.$emit("update:dialogueId",this.dialogueId+1)}}},handleKeyup:function(e){90===e.keyCode&&this.next()}},created:function(){window.addEventListener("keyup",this.handleKeyup)},mounted:function(){this.render(this.dialogue)},beforeDestroy:function(){window.removeEventListener("keyup",this.handleKeyup)},updated:function(){this.render(this.dialogue)}},Z=Y,ee=(n("8187"),Object(L["a"])(Z,N,z,!1,null,"660926e3",null));ee.options.__file="Msgbox.vue";var te=ee.exports,ne={components:{Menu:D,Msgbox:te},data:function(){return{status:{heroName:"",heroineName:"",storyMode:1,chapter:null,section:null,dialogueId:null},system:{width:window.innerWidth,height:window.innerHeight,sePlayer:new M,bgmPlayer:new x},config:{locale:"default"}}},computed:{screenSize:function(){return Math.min(this.system.width,this.system.height)},stories:function(){try{return n("1162")("./story".concat(this.status.storyMode,".").concat(this.config.locale,".json"))}catch(e){return n("21f8")("./story".concat(this.status.storyMode,".default.json"))}},dialogues:function(){var e=this.status,t=e.chapter,n=e.section;return this.loadDialogues(t,n)}},watch:{config:{handler:function(e,t){window.localStorage.setItem("epilogy-config",l()(e))},deep:!0}},methods:{loadConfig:function(){window.localStorage.getItem("epilogy-config")||window.localStorage.setItem("epilogy-config",l()(this.config));try{this.config=JSON.parse(window.localStorage.getItem("epilogy-config"))}catch(e){}},loadDialogues:function(e,t){var n=this.stories["".concat(e).concat(t?" ".concat(t):"")]||[];return this.compileDialogues(n)},compileDialogues:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var o,a=s()(e);!(n=(o=a.next()).done);n=!0){var u=o.value;t.push(O.compile(u))}}catch(l){i=!0,r=l}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t},onSePlay:function(e){this.system.sePlayer.play(e)},onBgmPlay:function(e){this.system.bgmPlayer.play(e)},handleResize:function(){this.system.width=window.innerWidth,this.system.height=window.innerHeight}},created:function(){window.addEventListener("resize",this.handleResize),this.loadConfig(),this.status.chapter=1,this.status.section=null,this.status.dialogueId=1},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}},ie=ne,re=(n("5b30"),n("10e4"),Object(L["a"])(ie,r,o,!1,null,"073400aa",null));re.options.__file="Epilogy.vue";var oe=re.exports;i["a"].config.productionTip=!1,new i["a"]({el:"Epilogy",render:function(e){return e(oe)}})},"5b30":function(e,t,n){"use strict";var i=n("3e52"),r=n.n(i);r.a},"64be":function(e,t,n){"use strict";var i=n("cb73"),r=n.n(i);r.a},7322:function(e,t,n){},8187:function(e,t,n){"use strict";var i=n("3a4e"),r=n.n(i);r.a},"90c2":function(e){e.exports={1:[]}},"9de3":function(e,t,n){e.exports=n.p+"media/ok.ac43fcda.mp3"},a3cc:function(e,t,n){"use strict";var i=n("7322"),r=n.n(i);r.a},c3fa:function(e,t,n){},cb73:function(e,t,n){},dc64:function(e){e.exports={1:[]}},f4f2:function(e,t,n){}});
//# sourceMappingURL=app.e763f0e5.js.map