(function(e){function t(t){for(var i,o,u=t[0],s=t[1],l=t[2],d=0,f=[];d<u.length;d++)o=u[d],r[o]&&f.push(r[o][0]),r[o]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);c&&c(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,u=1;u<n.length;u++){var s=n[u];0!==r[s]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={app:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var c=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0498":function(e,t,n){"use strict";var i=n("1ba5"),r=n.n(i);r.a},1162:function(e,t,n){var i={"./story1.default.json":"90c2","./story2.default.json":"dc64"};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id="1162"},"1a85":function(e,t,n){"use strict";var i=n("7f8b"),r=n.n(i);r.a},"1ba5":function(e,t,n){},"1f8b":function(e,t,n){e.exports=n.p+"img/dialog-background.c5ce8d6f.png"},"21eb":function(e,t,n){e.exports=n.p+"media/read.4b114e55.mp3"},"21f8":function(e,t,n){var i={"./story1.default.json":"90c2","./story2.default.json":"dc64"};function r(e){var t=a(e);return n(t)}function a(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id="21f8"},2382:function(e,t,n){},"4d42":function(e,t,n){"use strict";var i=n("d9da"),r=n.n(i);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Epilogy",{style:{width:e.screenSize+"px",height:e.screenSize+"px"}},[i("BackScreen",e._b({ref:"backScreen",attrs:{src:n("1f8b")}},"BackScreen",e.status,!1,!0)),i("Msgbox",e._b({on:{"seplayer:play":e.handleSePlay,"bgmplayer:play":e.handleBgmPlay,"fade-in:start":e.handleFadeIn,"fade-out:start":e.handleFadeOut}},"Msgbox",e.status,!1,!0)),i("Menu",{attrs:{title:"Main Menu"}})],1)},a=[],o=n("5d73"),u=n.n(o),s=n("f499"),l=n.n(s),c=n("308d"),d=n("6bb5"),f=n("4e2b"),h=n("f28b"),p=n("7618"),v=(n("6762"),n("2fdb"),n("a745")),y=n.n(v),g=n("d225"),m=n("b0b4"),b=n("a4bb"),w=n.n(b),O=(n("7514"),n("6b54"),function(){function e(){Object(g["a"])(this,e)}return Object(m["a"])(e,null,[{key:"getClassName",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{key:"isObject",value:function(e){return e instanceof Object&&!y()(e)}},{key:"includeKeys",value:function(e,t){return!!w()(e).find(function(e){return t.includes(e)})}}]),e}()),j=function(){function e(t){return Object(g["a"])(this,e),e.compile(t)}return Object(m["a"])(e,null,[{key:"compile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=[];switch(e.type){case"message":if(t)break;if(y()(e.value)){var i=!0,r=!1,a=void 0;try{for(var o,s=u()(e.value);!(i=(o=s.next()).done);i=!0){var l=o.value;n.push(this.compile(l,!0))}}catch(E){r=!0,a=E}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}break}return{type:e.type,value:e.value||"",label:e.label||{}};case"prompt":if(t||!y()(e.value))break;for(var c=0;c<e.value.length;c++){var d=e.value[c],f="",h={};if(["string","number"].includes(Object(p["a"])(d))&&(f=d),y()(d)){if(!d.length){e.value.splice(c,1),--c;continue}["string","number"].includes(Object(p["a"])(d[0]))&&(f=d[0]),O.isObject(d[1])&&(h=d[1])}O.isObject(d)&&(d.message&&(f=d.message),d.label&&(h=d.label)),e.value[c]={message:f,label:h}}return e;case"fade-in":if(O.isObject(e.value)){if(!e.value.duration)break;return{type:e.type,value:{to:e.value.to||"#000000",duration:e.value.duration},label:e.label||{}}}if("number"===typeof e.value)return{type:e.type,value:{to:"#000000",duration:e.value},label:e.label||{}};break;case"fade-out":if("number"===typeof e.value)return{type:e.type,value:e.value};break}if(["string","number"].includes(Object(p["a"])(e)))return t?e:{type:"message",value:e,label:{}};if(y()(e)){var v=!0,g=!1,m=void 0;try{for(var b,w=u()(e);!(v=(b=w.next()).done);v=!0){var j=b.value;n.push(this.compile(j,!0))}}catch(E){g=!0,m=E}finally{try{v||null==w.return||w.return()}finally{if(g)throw m}}}if(!n.length)throw new k;return{type:"message",value:n||"",label:e.label||{}}}}]),e}(),k=function(e){function t(){return Object(g["a"])(this,t),Object(c["a"])(this,Object(d["a"])(t).call(this,"The format of provided object doesn't match that of Dialogue"))}return Object(f["a"])(t,e),Object(m["a"])(t,[{key:"name",get:function(){return"DialogueCompileError"}}]),t}(Object(h["a"])(TypeError)),E=n("795b"),_=n.n(E),x=function(e){function t(){var e;return Object(g["a"])(this,t),e=Object(c["a"])(this,Object(d["a"])(t).call(this)),e.audios={},e}return Object(f["a"])(t,e),Object(m["a"])(t,[{key:"load",value:function(e){var t=this;return new _.a(function(n,i){t.audios[e]&&n(t.audios[e]);var r=new Audio(e);r.addEventListener("loadstart",function(){t.audios[e]=r,n(r)}),r.addEventListener("error",function(e){return i(e)})})}},{key:"play",value:function(e){this.load(e).then(function(e){return e.play()})}}]),t}(Object(h["a"])(AudioContext)),M=function(e){function t(){return Object(g["a"])(this,t),Object(c["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(f["a"])(t,e),t}(Object(h["a"])(AudioContext)),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-BackScreen",{style:{backgroundImage:"url("+e.attrs.src+")"}},[n("Style",{ref:"styleDom"})],1)},$=[],I=(n("c5f6"),n("e814")),L=n.n(I),P=(n("28a5"),n("2d1f")),D=n.n(P),N=function(){function e(){Object(g["a"])(this,e)}return Object(m["a"])(e,null,[{key:"multipleUpdate",value:function(e){for(var t=D()(e),n=0;n<t.length;n++){var i=t[n];this.$emit("update:".concat(i[0]),i[1])}}},{key:"hexToColor",value:function(e){var t=e.slice(1).split(/.{2}/),n=[],i=!0,r=!1,a=void 0;try{for(var o,s=u()(t);!(i=(o=s.next()).done);i=!0){var l=o.value;n.push(L()(l,16))}}catch(c){r=!0,a=c}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}}]),e}(),C={data:function(){return{attrs:{src:this.src}}},props:{chapter:{type:Number},section:{type:Number},dialogueId:{type:Number},src:{type:String,required:!1}},methods:{changeImage:function(e){this.src=e},startFadeIn:function(e){var t=this,n=this.$refs.styleDom,i=e.value,r=i.duration,a=i.to;this.$el.addEventListener("transitionend",function(){return t.endFadeIn(e)}),this.$el.style.transitionDuration="".concat(r,"ms"),n.innerHTML="epilogy-backscreen.fade-in { background-color: ".concat(a," }"),this.$el.classList.add("fade-in")},endFadeIn:function(e){var t=this;return this.$el.removeEventListener("transitionend",function(){return t.endFadeIn(e)}),this.$el.style.transitionDuration="",O.includeKeys(e.label,["chapter","section","dialogue"])?N.multipleUpdate.call(this,{chapter:e.label.chapter||this.chapter,section:e.label.section||this.section,dialogueId:e.label.dialogue||1}):this.$emit("update:dialogueId",this.dialogueId+1)},startFadeOut:function(e){var t=this,n=e.value.duration;this.$el.addEventListener("transitionend",function(){return t.endFadeOut(e)}),this.$el.style.transitionDuration="".concat(n,"ms"),this.$el.classList.remove("fade-in")},endFadeOut:function(e){var t=this;this.$el.removeEventListener("transitionend",function(){return t.endFadeOut(e)});var n=this.$refs.styleDom;n.innerHTML="",this.$emit("update:dialogueId",this.dialogueId+1)}}},F=C,T=(n("1a85"),n("2877")),z=Object(T["a"])(F,S,$,!1,null,"7bb9939f",null);z.options.__file="BackScreen.vue";var B=z.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-Menu",{attrs:{open:e.attrs.open&&""}},[n("Epilogy-Menutitle",[e._v(e._s(e.attrs.title))]),n("Epilogy-Menulist",e._l(e.items,function(t){return n("Epilogy-Menuitem",{key:t},[e._v(e._s(t))])}),1)],1)},K=[],R={props:{title:{type:String,required:!1},open:{type:Boolean,required:!1}},data:function(){return{attrs:{title:this.title,open:this.open},items:[]}},methods:{switch:function(){this.attrs.open=!this.attrs.open}},created:function(){var e=this;window.addEventListener("keydown",function(t){32===t.keyCode&&e.switch()}),window.addEventListener("keydown",function(e){switch(e.keyCode){case 38:break;case 40:break}})}},A=R,H=(n("9786"),Object(T["a"])(A,U,K,!1,null,"b37e3964",null));H.options.__file="Menu.vue";var Q=H.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-Msgbox",{attrs:{open:e.open&&""}},[n("SimpleMessage",{ref:"simpleMsg"}),n("PromptMessage",{ref:"promptMsg"})],1)},J=[],W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-SimpleMessage",e._l(e.message,function(t,i){return n("Span",{key:i},[e._v(e._s(t))])}),1)},G=[],V={data:function(){return{message:"",readQues:[]}},methods:{startReading:function(){var e=this,t=this.$el.children,n=!0,i=!1,r=void 0;try{for(var a,o=u()(t);!(n=(a=o.next()).done);n=!0){var s=a.value;s.removeAttribute("read")}}catch(d){i=!0,r=d}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}for(var l=function(n){e.readQues[n]=setTimeout(function(){e.readQues[n]=null,t[n].setAttribute("read","")},50*n)},c=0;c<t.length;c++)l(c)},stopReading:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=u()(this.readQues);!(e=(i=r.next()).done);e=!0){var a=i.value;null!=a&&clearTimeout(a)}}catch(o){t=!0,n=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},updated:function(){var e=this;this.stopReading(),this.$nextTick().then(function(){e.startReading()})}},X=V,Y=(n("c8d1"),Object(T["a"])(X,W,G,!1,null,"5e8707c6",null));Y.options.__file="SimpleMessage.vue";var Z=Y.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Epilogy-PromptMessage",e._l(e.items,function(t,i){return n("Li",{key:i,attrs:{tabIndex:i+1}},[n("Span",[e._v(e._s(t.message))])],1)}),1)},te=[],ne={data:function(){return{items:[]}},methods:{initSelection:function(){document.activeElement.matches("Epilogy-PromptMessage > Li")||this.$el.firstElementChild&&this.$el.firstElementChild.focus()},prev:function(){document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus()},next:function(){document.activeElement.nextElementSibling&&document.activeElement.nextElementSibling.focus()},handlekeyup:function(e){this.initSelection(),38===e.keyCode&&this.prev(),40===e.keyCode&&this.next()}},created:function(){window.addEventListener("keyup",this.handlekeyup)},beforeDestroy:function(){window.removeEventListener("keyup",this.handlekeyup)}},ie=ne,re=(n("6081"),Object(T["a"])(ie,ee,te,!1,null,"18c74bc8",null));re.options.__file="PromptMessage.vue";var ae=re.exports,oe={components:{SimpleMessage:Z,PromptMessage:ae},props:{chapter:{type:Number},section:{type:Number},dialogueId:{type:Number}},computed:{dialogue:function(){var e=this.$parent.dialogues;return e&&e[this.dialogueId-1]||null},open:function(){return null!=this.dialogue}},methods:{clear:function(){var e=this.$refs,t=e.simpleMsg,n=e.promptMsg;t.message="",n.items=[]},render:function(e){var t=this.$refs,i=t.simpleMsg,r=t.promptMsg;if(!e)return this.clear();switch(e.type){default:if(this.clear(),this.$emit("seplayer:play",n("21eb")),"message"===e.type){if("string"===typeof e.value)return i.message=e.value;if(y()(e.value))return i.message=e.value.join("\n")}if("prompt"===e.type)return r.items=e.value;break;case"fade-in":return this.$emit("fade-in:start",e);case"fade-out":return this.$emit("fade-out:start",e)}},prev:function(){this.$emit("update:dialogueId",this.dialogueId-1)},next:function(){if(this.dialogue){if("message"===this.dialogue.type)return O.includeKeys(this.dialogue.label,["chapter","section","dialogue"])?N.multipleUpdate.call(this,{chapter:this.dialogue.label.chapter||this.chapter,section:this.dialogue.label.section||this.section,dialogueId:this.dialogue.label.dialogue||1}):this.$emit("update:dialogueId",this.dialogueId+1);if("prompt"===this.dialogue.type){if(!document.activeElement.matches("Epilogy-PromptMessage > Li"))return;var e=this.dialogue.value[document.activeElement.tabIndex-1];return O.includeKeys(e.label,["chapter","section","dialogue"])?N.multipleUpdate.call(this,{chapter:e.label.chapter||this.chapter,section:e.label.section||this.section,dialogueId:e.label.dialogue||1}):this.$emit("update:dialogueId",this.dialogueId+1)}}},handleKeyup:function(e){90===e.keyCode&&this.next()}},created:function(){window.addEventListener("keyup",this.handleKeyup)},mounted:function(){this.render(this.dialogue)},beforeDestroy:function(){window.removeEventListener("keyup",this.handleKeyup)},updated:function(){this.render(this.dialogue)}},ue=oe,se=(n("0498"),Object(T["a"])(ue,q,J,!1,null,"6b100b83",null));se.options.__file="Msgbox.vue";var le=se.exports,ce={components:{BackScreen:B,Menu:Q,Msgbox:le},data:function(){return{status:{heroName:"",heroineName:"",storyMode:1,chapter:null,section:null,dialogueId:null},system:{width:window.innerWidth,height:window.innerHeight,sePlayer:new x,bgmPlayer:new M},config:{locale:"default",readSpeed:50}}},computed:{screenSize:function(){return Math.min(this.system.width,this.system.height)},stories:function(){try{return n("1162")("./story".concat(this.status.storyMode,".").concat(this.config.locale,".json"))}catch(e){return n("21f8")("./story".concat(this.status.storyMode,".default.json"))}},dialogues:function(){var e=this.status,t=e.chapter,n=e.section;return this.loadDialogues(t,n)}},watch:{config:{handler:function(e,t){window.localStorage.setItem("epilogy-config",l()(e))},deep:!0}},methods:{loadConfig:function(){window.localStorage.getItem("epilogy-config")||window.localStorage.setItem("epilogy-config",l()(this.config));try{this.config=JSON.parse(window.localStorage.getItem("epilogy-config"))}catch(e){}},loadDialogues:function(e,t){var n=this.stories["".concat(e).concat(t?" ".concat(t):"")]||[];return this.compileDialogues(n)},compileDialogues:function(e){var t=[],n=!0,i=!1,r=void 0;try{for(var a,o=u()(e);!(n=(a=o.next()).done);n=!0){var s=a.value;t.push(j.compile(s))}}catch(l){i=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return t},handleSePlay:function(e){this.system.sePlayer.play(e)},handleBgmPlay:function(e){this.system.bgmPlayer.play(e)},handleFadeIn:function(e){this.$refs.backScreen.startFadeIn(e)},handleFadeOut:function(e){this.$refs.backScreen.startFadeOut(e)},handleResize:function(){this.system.width=window.innerWidth,this.system.height=window.innerHeight}},created:function(){window.addEventListener("resize",this.handleResize),this.loadConfig(),this.status.chapter=1,this.status.section=null,this.status.dialogueId=1},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}},de=ce,fe=(n("fbc8"),n("4d42"),Object(T["a"])(de,r,a,!1,null,"7a533e33",null));fe.options.__file="Epilogy.vue";var he=fe.exports;i["a"].config.productionTip=!1,new i["a"]({el:"Epilogy",render:function(e){return e(he)}})},6081:function(e,t,n){"use strict";var i=n("e501"),r=n.n(i);r.a},"7f8b":function(e,t,n){},"90c2":function(e){e.exports={1:["―― 西暦二〇一八年　某日",["荒木先生","「えー、先日みなさんにお知らせしたとおり、今日のホームルームでは、修学旅行の班決めと係決めを行いたいと思います」"],{type:"fade-in",value:{to:"#000000",duration:500},label:{dialogue:5}},{type:"fade-out",value:500},["荒木先生","「班は普段の座席通り、1班4人になるように分けましたので、指示に従って移動してください」"],["荒木先生","「あっ、{{ heroName }}さん」"],["{{ heroName }}","「はい、なんでしょう」"],["荒木先生","「今日は佐々木さんが欠席なので、あっちの班に移動してくれるとありがたいんですけど」"],["{{ heroName }}","「あ、わかりました」"]]}},9786:function(e,t,n){"use strict";var i=n("2382"),r=n.n(i);r.a},b853:function(e,t,n){},c8d1:function(e,t,n){"use strict";var i=n("b853"),r=n.n(i);r.a},d9da:function(e,t,n){},dc64:function(e){e.exports={1:[]}},e501:function(e,t,n){},e584:function(e,t,n){},fbc8:function(e,t,n){"use strict";var i=n("e584"),r=n.n(i);r.a}});
//# sourceMappingURL=app.922ef4e7.js.map